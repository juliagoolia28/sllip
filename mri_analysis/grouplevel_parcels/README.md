## Group Level Parcellation Analysis
This analysis, and much of the code, is adapted from [Terri Scott](https://github.com/tlscott/make_parcels). Please cite the following before using:

Scott, T.L. and Perrachione, T.K. (2019). Common cortical architectures for phonological working memory identified in individual brains. NeuroImage, 202, 116096. DOI: 10.1016/j.neuroimage.2019.116096.
https://pubmed.ncbi.nlm.nih.gov/31415882/

In addition to extracting the magnitude of response within the top 10% of voxels within a parcel, we may choose to extract the beta weights from each contrast within each parcel. Here are the steps to conduct that analysis:
- Extract each parcel mask, using fslmaths from the parcels_sig.nii.gz file within the parcels folder
```
fslmaths -dt int ssl_str_rd_probability_map_thresh2subjs_smoothed_parcels_sig.nii.gz -thr 1 -uthr 1 -bin parcel_1
fslmaths -dt int ssl_str_rd_probability_map_thresh2subjs_smoothed_parcels_sig.nii.gz -thr 3 -uthr 3 -bin parcel_3
fslmaths -dt int ssl_str_rd_probability_map_thresh2subjs_smoothed_parcels_sig.nii.gz -thr 5 -uthr 5 -bin parcel_5
fslmaths -dt int ssl_str_rd_probability_map_thresh2subjs_smoothed_parcels_sig.nii.gz -thr 8 -uthr 8 -bin parcel_8
fslmaths -dt int ssl_str_rd_probability_map_thresh2subjs_smoothed_parcels_sig.nii.gz -thr 13 -uthr 13 -bin parcel_13
```
- Next run featquery to extract beta weights from within each parcel
```
/usr/local/fsl/bin/featquery 30 /Users/qigroup/mnt/sylvian/sllip/dicom_conversion/derivatives/fsl/higherlevelanalysis/sllip_001/ASL.gfeat/cope2.feat /Users/qigroup/mnt/sylvian/sllip/dicom_conversion/derivatives/fsl/higherlevelanalysis/sllip_002/ASL.gfeat/cope2.feat /Users/qigroup/mnt/sylvian/sllip/dicom_conversion/derivatives/fsl/higherlevelanalysis/sllip_005/ASL.gfeat/cope2.feat /Users/qigroup/mnt/sylvian/sllip/dicom_conversion/derivatives/fsl/higherlevelanalysis/sllip_006/ASL.gfeat/cope2.feat /Users/qigroup/mnt/sylvian/sllip/dicom_conversion/derivatives/fsl/higherlevelanalysis/sllip_007/ASL.gfeat/cope2.feat /Users/qigroup/mnt/sylvian/sllip/dicom_conversion/derivatives/fsl/higherlevelanalysis/sllip_008/ASL.gfeat/cope2.feat /Users/qigroup/mnt/sylvian/sllip/dicom_conversion/derivatives/fsl/higherlevelanalysis/sllip_009/ASL.gfeat/cope2.feat /Users/qigroup/mnt/sylvian/sllip/dicom_conversion/derivatives/fsl/higherlevelanalysis/sllip_011/ASL.gfeat/cope2.feat /Users/qigroup/mnt/sylvian/sllip/dicom_conversion/derivatives/fsl/higherlevelanalysis/sllip_013/ASL.gfeat/cope2.feat /Users/qigroup/mnt/sylvian/sllip/dicom_conversion/derivatives/fsl/higherlevelanalysis/sllip_014/ASL.gfeat/cope2.feat /Users/qigroup/mnt/sylvian/sllip/dicom_conversion/derivatives/fsl/higherlevelanalysis/sllip_016/ASL.gfeat/cope2.feat /Users/qigroup/mnt/sylvian/sllip/dicom_conversion/derivatives/fsl/higherlevelanalysis/sllip_019/ASL.gfeat/cope2.feat /Users/qigroup/mnt/sylvian/sllip/dicom_conversion/derivatives/fsl/higherlevelanalysis/sllip_023/ASL.gfeat/cope2.feat /Users/qigroup/mnt/sylvian/sllip/dicom_conversion/derivatives/fsl/higherlevelanalysis/sllip_025/ASL.gfeat/cope2.feat /Users/qigroup/mnt/sylvian/sllip/dicom_conversion/derivatives/fsl/higherlevelanalysis/sllip_026/ASL.gfeat/cope2.feat /Users/qigroup/mnt/sylvian/sllip/dicom_conversion/derivatives/fsl/higherlevelanalysis/sllip_027/ASL.gfeat/cope2.feat /Users/qigroup/mnt/sylvian/sllip/dicom_conversion/derivatives/fsl/higherlevelanalysis/sllip_029/ASL.gfeat/cope2.feat /Users/qigroup/mnt/sylvian/sllip/dicom_conversion/derivatives/fsl/higherlevelanalysis/sllip_030/ASL.gfeat/cope2.feat /Users/qigroup/mnt/sylvian/sllip/dicom_conversion/derivatives/fsl/higherlevelanalysis/sllip_037/ASL.gfeat/cope2.feat /Users/qigroup/mnt/sylvian/sllip/dicom_conversion/derivatives/fsl/higherlevelanalysis/sllip_038/ASL.gfeat/cope2.feat /Users/qigroup/mnt/sylvian/sllip/dicom_conversion/derivatives/fsl/higherlevelanalysis/sllip_039/ASL.gfeat/cope2.feat /Users/qigroup/mnt/sylvian/sllip/dicom_conversion/derivatives/fsl/higherlevelanalysis/sllip_046/ASL.gfeat/cope2.feat /Users/qigroup/mnt/sylvian/sllip/dicom_conversion/derivatives/fsl/higherlevelanalysis/sllip_047/ASL.gfeat/cope2.feat /Users/qigroup/mnt/sylvian/sllip/dicom_conversion/derivatives/fsl/higherlevelanalysis/sllip_049/ASL.gfeat/cope2.feat /Users/qigroup/mnt/sylvian/sllip/dicom_conversion/derivatives/fsl/higherlevelanalysis/sllip_050/ASL.gfeat/cope2.feat /Users/qigroup/mnt/sylvian/sllip/dicom_conversion/derivatives/fsl/higherlevelanalysis/sllip_051/ASL.gfeat/cope2.feat /Users/qigroup/mnt/sylvian/sllip/dicom_conversion/derivatives/fsl/higherlevelanalysis/sllip_054/ASL.gfeat/cope2.feat /Users/qigroup/mnt/sylvian/sllip/dicom_conversion/derivatives/fsl/higherlevelanalysis/sllip_060/ASL.gfeat/cope2.feat /Users/qigroup/mnt/sylvian/sllip/dicom_conversion/derivatives/fsl/higherlevelanalysis/sllip_061/ASL.gfeat/cope2.feat /Users/qigroup/mnt/sylvian/sllip/dicom_conversion/derivatives/fsl/higherlevelanalysis/sllip_064/ASL.gfeat/cope2.feat 2  stats/zstat1 stats/zstat2 featquery_parcel1 /Volumes/data/users/julie/make_parcels-julie/parcels/sllip/ssl_str_rd_60pct_thresh2.326_14-Apr-2021/parcel_1.nii.gz
```
- Once you have extracted beta weights from each parcel, copy all report.txt files to one centralized location using the script featquery_report_rename.sh

